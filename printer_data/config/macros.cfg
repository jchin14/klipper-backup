[gcode_macro START_PRINT]
gcode:
    {% set BED_TEMP = params.BED_TEMP|default(55)|float %}
    {% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(210)|float %}

    BED_MESH_PROFILE LOAD=default

    # Start heating
    M140 S{BED_TEMP}
    M104 S170 ; preheat to prevent oozing

    # Wait for bed
    M190 S{BED_TEMP}
    G4 P2000 ; 2s heat soak

    # Home
    G90
    M83
    G28

    # Final nozzle temp
    M104 S{EXTRUDER_TEMP}
    M109 S{EXTRUDER_TEMP}

    # Prime L-shape: 2 layers, each 2 lines wide, at 0.2mm height
    G1 X10 Y2 F1500
    G1 Z0.2 F3000
    G92 E0

    # --- Layer 1 ---
    # Horizontal line 1
    G1 X120 E4 F600
    # Horizontal line 2 (offset)
    G1 X20 Y5.4 F600
    G1 X120 E4 F600
    # Vertical line 1
    G1 X120 Y15.4 E0.4 F600
    # Vertical line 2 (offset)
    G1 X119.6 Y5.4 E0.4 F600

    # --- Layer 2 ---
    G1 Z0.4 F300
    # Horizontal line 1
    G1 X20 Y5 F1500
    G1 X120 E4 F600
    # Horizontal line 2 (offset)
    G1 X20 Y5.4 F600
    G1 X120 E4 F600
    # Vertical line 1
    G1 X120 Y15.4 E0.4 F600
    # Vertical line 2 (offset)
    G1 X119.6 Y5.4 E0.4 F600

    G92 E0 ; reset extrusion
